{"ast":null,"code":"import{useEffect,useState}from\"react\";import api from\"../api\";// Reusable Card\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ReportCard=_ref=>{let{title,value,color}=_ref;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg p-6 border-t-4 \".concat(color),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 font-semibold\",children:title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold mt-2\",children:value})]});};const AdminReports=()=>{const[stats,setStats]=useState({totalInvoices:0,paidInvoices:0,pendingInvoices:0,totalRevenue:0,pendingRevenue:0,newLeads:0,inProgressLeads:0,convertedLeads:0});const[loading,setLoading]=useState(true);useEffect(()=>{const fetchReports=async()=>{try{var _ref2,_invoicesRes$data$ite,_ref3,_leadsRes$data$items;// ðŸ”¹ Invoices\nconst invoicesRes=await api.get(\"/invoices\");const invoices=(_ref2=(_invoicesRes$data$ite=invoicesRes.data.items)!==null&&_invoicesRes$data$ite!==void 0?_invoicesRes$data$ite:invoicesRes.data)!==null&&_ref2!==void 0?_ref2:[];const paidInvoices=invoices.filter(inv=>{var _inv$status;return[\"paid\",\"success\"].includes((_inv$status=inv.status)===null||_inv$status===void 0?void 0:_inv$status.toLowerCase());});const pendingInvoices=invoices.filter(inv=>{var _inv$status2;return[\"pending\",\"unpaid\"].includes((_inv$status2=inv.status)===null||_inv$status2===void 0?void 0:_inv$status2.toLowerCase());});const totalRevenue=paidInvoices.reduce((sum,inv)=>sum+Number(inv.amount||inv.total||0),0);const pendingRevenue=pendingInvoices.reduce((sum,inv)=>sum+Number(inv.amount||inv.total||0),0);// ðŸ”¹ Leads\nconst leadsRes=await api.get(\"/leads\");const leads=(_ref3=(_leadsRes$data$items=leadsRes.data.items)!==null&&_leadsRes$data$items!==void 0?_leadsRes$data$items:leadsRes.data)!==null&&_ref3!==void 0?_ref3:[];const newLeads=leads.filter(l=>{var _l$status;return((_l$status=l.status)===null||_l$status===void 0?void 0:_l$status.toLowerCase())===\"new\";}).length;const inProgressLeads=leads.filter(l=>{var _l$status2;return((_l$status2=l.status)===null||_l$status2===void 0?void 0:_l$status2.toLowerCase())===\"in progress\";}).length;const convertedLeads=leads.filter(l=>{var _l$status3;return((_l$status3=l.status)===null||_l$status3===void 0?void 0:_l$status3.toLowerCase())===\"converted\";}).length;setStats({totalInvoices:invoices.length,paidInvoices:paidInvoices.length,pendingInvoices:pendingInvoices.length,totalRevenue,pendingRevenue,newLeads,inProgressLeads,convertedLeads});}catch(err){var _err$response;console.error(\"Reports fetch error:\",((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message);alert(\"Failed to load reports\");}finally{setLoading(false);}};fetchReports();},[]);if(loading)return/*#__PURE__*/_jsx(\"p\",{className:\"text-center mt-10\",children:\"Loading Reports...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex flex-col p-8 space-y-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800\",children:\"Admin Reports\"}),/*#__PURE__*/_jsxs(\"section\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsx(ReportCard,{title:\"Total Invoices\",value:stats.totalInvoices,color:\"border-blue-600\"}),/*#__PURE__*/_jsx(ReportCard,{title:\"Paid Invoices\",value:stats.paidInvoices,color:\"border-green-600\"}),/*#__PURE__*/_jsx(ReportCard,{title:\"Pending Invoices\",value:stats.pendingInvoices,color:\"border-amber-600\"}),/*#__PURE__*/_jsx(ReportCard,{title:\"Total Revenue\",value:\"\\u20B9\".concat(stats.totalRevenue),color:\"border-teal-600\"}),/*#__PURE__*/_jsx(ReportCard,{title:\"Pending Revenue\",value:\"\\u20B9\".concat(stats.pendingRevenue),color:\"border-red-600\"}),/*#__PURE__*/_jsx(ReportCard,{title:\"New Leads\",value:stats.newLeads,color:\"border-purple-600\"}),/*#__PURE__*/_jsx(ReportCard,{title:\"Leads In Progress\",value:stats.inProgressLeads,color:\"border-indigo-600\"}),/*#__PURE__*/_jsx(ReportCard,{title:\"Converted Leads\",value:stats.convertedLeads,color:\"border-green-700\"})]})]});};export default AdminReports;","map":{"version":3,"names":["useEffect","useState","api","jsx","_jsx","jsxs","_jsxs","ReportCard","_ref","title","value","color","className","concat","children","AdminReports","stats","setStats","totalInvoices","paidInvoices","pendingInvoices","totalRevenue","pendingRevenue","newLeads","inProgressLeads","convertedLeads","loading","setLoading","fetchReports","_ref2","_invoicesRes$data$ite","_ref3","_leadsRes$data$items","invoicesRes","get","invoices","data","items","filter","inv","_inv$status","includes","status","toLowerCase","_inv$status2","reduce","sum","Number","amount","total","leadsRes","leads","l","_l$status","length","_l$status2","_l$status3","err","_err$response","console","error","response","message","alert"],"sources":["C:/Users/AK/OneDrive/Attachments/Desktop/CRM/flow-crm/frontend/src/Pages/AdminReports.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport api from \"../api\";\r\n\r\n// Reusable Card\r\nconst ReportCard = ({ title, value, color }) => (\r\n  <div className={`bg-white rounded-2xl shadow-lg p-6 border-t-4 ${color}`}>\r\n    <p className=\"text-gray-600 font-semibold\">{title}</p>\r\n    <p className=\"text-2xl font-bold mt-2\">{value}</p>\r\n  </div>\r\n);\r\n\r\nconst AdminReports = () => {\r\n  const [stats, setStats] = useState({\r\n    totalInvoices: 0,\r\n    paidInvoices: 0,\r\n    pendingInvoices: 0,\r\n    totalRevenue: 0,\r\n    pendingRevenue: 0,\r\n    newLeads: 0,\r\n    inProgressLeads: 0,\r\n    convertedLeads: 0,\r\n  });\r\n\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const fetchReports = async () => {\r\n      try {\r\n        // ðŸ”¹ Invoices\r\n        const invoicesRes = await api.get(\"/invoices\");\r\n        const invoices = invoicesRes.data.items ?? invoicesRes.data ?? [];\r\n        const paidInvoices = invoices.filter(inv => [\"paid\", \"success\"].includes(inv.status?.toLowerCase()));\r\n        const pendingInvoices = invoices.filter(inv => [\"pending\", \"unpaid\"].includes(inv.status?.toLowerCase()));\r\n        const totalRevenue = paidInvoices.reduce((sum, inv) => sum + Number(inv.amount || inv.total || 0), 0);\r\n        const pendingRevenue = pendingInvoices.reduce((sum, inv) => sum + Number(inv.amount || inv.total || 0), 0);\r\n\r\n        // ðŸ”¹ Leads\r\n        const leadsRes = await api.get(\"/leads\");\r\n        const leads = leadsRes.data.items ?? leadsRes.data ?? [];\r\n        const newLeads = leads.filter(l => l.status?.toLowerCase() === \"new\").length;\r\n        const inProgressLeads = leads.filter(l => l.status?.toLowerCase() === \"in progress\").length;\r\n        const convertedLeads = leads.filter(l => l.status?.toLowerCase() === \"converted\").length;\r\n\r\n        setStats({\r\n          totalInvoices: invoices.length,\r\n          paidInvoices: paidInvoices.length,\r\n          pendingInvoices: pendingInvoices.length,\r\n          totalRevenue,\r\n          pendingRevenue,\r\n          newLeads,\r\n          inProgressLeads,\r\n          convertedLeads,\r\n        });\r\n      } catch (err) {\r\n        console.error(\"Reports fetch error:\", err.response?.data || err.message);\r\n        alert(\"Failed to load reports\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchReports();\r\n  }, []);\r\n\r\n  if (loading) return <p className=\"text-center mt-10\">Loading Reports...</p>;\r\n\r\n  return (\r\n    <div className=\"flex-1 flex flex-col p-8 space-y-8\">\r\n      <h2 className=\"text-3xl font-bold text-gray-800\">Admin Reports</h2>\r\n\r\n      <section className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n        <ReportCard title=\"Total Invoices\" value={stats.totalInvoices} color=\"border-blue-600\" />\r\n        <ReportCard title=\"Paid Invoices\" value={stats.paidInvoices} color=\"border-green-600\" />\r\n        <ReportCard title=\"Pending Invoices\" value={stats.pendingInvoices} color=\"border-amber-600\" />\r\n        <ReportCard title=\"Total Revenue\" value={`â‚¹${stats.totalRevenue}`} color=\"border-teal-600\" />\r\n        <ReportCard title=\"Pending Revenue\" value={`â‚¹${stats.pendingRevenue}`} color=\"border-red-600\" />\r\n        <ReportCard title=\"New Leads\" value={stats.newLeads} color=\"border-purple-600\" />\r\n        <ReportCard title=\"Leads In Progress\" value={stats.inProgressLeads} color=\"border-indigo-600\" />\r\n        <ReportCard title=\"Converted Leads\" value={stats.convertedLeads} color=\"border-green-700\" />\r\n      </section>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminReports;\r\n"],"mappings":"AAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,MAAO,CAAAC,GAAG,KAAM,QAAQ,CAExB;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBACA,KAAM,CAAAC,UAAU,CAAGC,IAAA,MAAC,CAAEC,KAAK,CAAEC,KAAK,CAAEC,KAAM,CAAC,CAAAH,IAAA,oBACzCF,KAAA,QAAKM,SAAS,kDAAAC,MAAA,CAAmDF,KAAK,CAAG,CAAAG,QAAA,eACvEV,IAAA,MAAGQ,SAAS,CAAC,6BAA6B,CAAAE,QAAA,CAAEL,KAAK,CAAI,CAAC,cACtDL,IAAA,MAAGQ,SAAS,CAAC,yBAAyB,CAAAE,QAAA,CAAEJ,KAAK,CAAI,CAAC,EAC/C,CAAC,EACP,CAED,KAAM,CAAAK,YAAY,CAAGA,CAAA,GAAM,CACzB,KAAM,CAACC,KAAK,CAAEC,QAAQ,CAAC,CAAGhB,QAAQ,CAAC,CACjCiB,aAAa,CAAE,CAAC,CAChBC,YAAY,CAAE,CAAC,CACfC,eAAe,CAAE,CAAC,CAClBC,YAAY,CAAE,CAAC,CACfC,cAAc,CAAE,CAAC,CACjBC,QAAQ,CAAE,CAAC,CACXC,eAAe,CAAE,CAAC,CAClBC,cAAc,CAAE,CAClB,CAAC,CAAC,CAEF,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAG1B,QAAQ,CAAC,IAAI,CAAC,CAE5CD,SAAS,CAAC,IAAM,CACd,KAAM,CAAA4B,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,KAAAC,KAAA,CAAAC,qBAAA,CAAAC,KAAA,CAAAC,oBAAA,CACF;AACA,KAAM,CAAAC,WAAW,CAAG,KAAM,CAAA/B,GAAG,CAACgC,GAAG,CAAC,WAAW,CAAC,CAC9C,KAAM,CAAAC,QAAQ,EAAAN,KAAA,EAAAC,qBAAA,CAAGG,WAAW,CAACG,IAAI,CAACC,KAAK,UAAAP,qBAAA,UAAAA,qBAAA,CAAIG,WAAW,CAACG,IAAI,UAAAP,KAAA,UAAAA,KAAA,CAAI,EAAE,CACjE,KAAM,CAAAV,YAAY,CAAGgB,QAAQ,CAACG,MAAM,CAACC,GAAG,OAAAC,WAAA,OAAI,CAAC,MAAM,CAAE,SAAS,CAAC,CAACC,QAAQ,EAAAD,WAAA,CAACD,GAAG,CAACG,MAAM,UAAAF,WAAA,iBAAVA,WAAA,CAAYG,WAAW,CAAC,CAAC,CAAC,GAAC,CACpG,KAAM,CAAAvB,eAAe,CAAGe,QAAQ,CAACG,MAAM,CAACC,GAAG,OAAAK,YAAA,OAAI,CAAC,SAAS,CAAE,QAAQ,CAAC,CAACH,QAAQ,EAAAG,YAAA,CAACL,GAAG,CAACG,MAAM,UAAAE,YAAA,iBAAVA,YAAA,CAAYD,WAAW,CAAC,CAAC,CAAC,GAAC,CACzG,KAAM,CAAAtB,YAAY,CAAGF,YAAY,CAAC0B,MAAM,CAAC,CAACC,GAAG,CAAEP,GAAG,GAAKO,GAAG,CAAGC,MAAM,CAACR,GAAG,CAACS,MAAM,EAAIT,GAAG,CAACU,KAAK,EAAI,CAAC,CAAC,CAAE,CAAC,CAAC,CACrG,KAAM,CAAA3B,cAAc,CAAGF,eAAe,CAACyB,MAAM,CAAC,CAACC,GAAG,CAAEP,GAAG,GAAKO,GAAG,CAAGC,MAAM,CAACR,GAAG,CAACS,MAAM,EAAIT,GAAG,CAACU,KAAK,EAAI,CAAC,CAAC,CAAE,CAAC,CAAC,CAE1G;AACA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAhD,GAAG,CAACgC,GAAG,CAAC,QAAQ,CAAC,CACxC,KAAM,CAAAiB,KAAK,EAAApB,KAAA,EAAAC,oBAAA,CAAGkB,QAAQ,CAACd,IAAI,CAACC,KAAK,UAAAL,oBAAA,UAAAA,oBAAA,CAAIkB,QAAQ,CAACd,IAAI,UAAAL,KAAA,UAAAA,KAAA,CAAI,EAAE,CACxD,KAAM,CAAAR,QAAQ,CAAG4B,KAAK,CAACb,MAAM,CAACc,CAAC,OAAAC,SAAA,OAAI,EAAAA,SAAA,CAAAD,CAAC,CAACV,MAAM,UAAAW,SAAA,iBAARA,SAAA,CAAUV,WAAW,CAAC,CAAC,IAAK,KAAK,GAAC,CAACW,MAAM,CAC5E,KAAM,CAAA9B,eAAe,CAAG2B,KAAK,CAACb,MAAM,CAACc,CAAC,OAAAG,UAAA,OAAI,EAAAA,UAAA,CAAAH,CAAC,CAACV,MAAM,UAAAa,UAAA,iBAARA,UAAA,CAAUZ,WAAW,CAAC,CAAC,IAAK,aAAa,GAAC,CAACW,MAAM,CAC3F,KAAM,CAAA7B,cAAc,CAAG0B,KAAK,CAACb,MAAM,CAACc,CAAC,OAAAI,UAAA,OAAI,EAAAA,UAAA,CAAAJ,CAAC,CAACV,MAAM,UAAAc,UAAA,iBAARA,UAAA,CAAUb,WAAW,CAAC,CAAC,IAAK,WAAW,GAAC,CAACW,MAAM,CAExFrC,QAAQ,CAAC,CACPC,aAAa,CAAEiB,QAAQ,CAACmB,MAAM,CAC9BnC,YAAY,CAAEA,YAAY,CAACmC,MAAM,CACjClC,eAAe,CAAEA,eAAe,CAACkC,MAAM,CACvCjC,YAAY,CACZC,cAAc,CACdC,QAAQ,CACRC,eAAe,CACfC,cACF,CAAC,CAAC,CACJ,CAAE,MAAOgC,GAAG,CAAE,KAAAC,aAAA,CACZC,OAAO,CAACC,KAAK,CAAC,sBAAsB,CAAE,EAAAF,aAAA,CAAAD,GAAG,CAACI,QAAQ,UAAAH,aAAA,iBAAZA,aAAA,CAActB,IAAI,GAAIqB,GAAG,CAACK,OAAO,CAAC,CACxEC,KAAK,CAAC,wBAAwB,CAAC,CACjC,CAAC,OAAS,CACRpC,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAEDC,YAAY,CAAC,CAAC,CAChB,CAAC,CAAE,EAAE,CAAC,CAEN,GAAIF,OAAO,CAAE,mBAAOtB,IAAA,MAAGQ,SAAS,CAAC,mBAAmB,CAAAE,QAAA,CAAC,oBAAkB,CAAG,CAAC,CAE3E,mBACER,KAAA,QAAKM,SAAS,CAAC,oCAAoC,CAAAE,QAAA,eACjDV,IAAA,OAAIQ,SAAS,CAAC,kCAAkC,CAAAE,QAAA,CAAC,eAAa,CAAI,CAAC,cAEnER,KAAA,YAASM,SAAS,CAAC,uCAAuC,CAAAE,QAAA,eACxDV,IAAA,CAACG,UAAU,EAACE,KAAK,CAAC,gBAAgB,CAACC,KAAK,CAAEM,KAAK,CAACE,aAAc,CAACP,KAAK,CAAC,iBAAiB,CAAE,CAAC,cACzFP,IAAA,CAACG,UAAU,EAACE,KAAK,CAAC,eAAe,CAACC,KAAK,CAAEM,KAAK,CAACG,YAAa,CAACR,KAAK,CAAC,kBAAkB,CAAE,CAAC,cACxFP,IAAA,CAACG,UAAU,EAACE,KAAK,CAAC,kBAAkB,CAACC,KAAK,CAAEM,KAAK,CAACI,eAAgB,CAACT,KAAK,CAAC,kBAAkB,CAAE,CAAC,cAC9FP,IAAA,CAACG,UAAU,EAACE,KAAK,CAAC,eAAe,CAACC,KAAK,UAAAG,MAAA,CAAMG,KAAK,CAACK,YAAY,CAAG,CAACV,KAAK,CAAC,iBAAiB,CAAE,CAAC,cAC7FP,IAAA,CAACG,UAAU,EAACE,KAAK,CAAC,iBAAiB,CAACC,KAAK,UAAAG,MAAA,CAAMG,KAAK,CAACM,cAAc,CAAG,CAACX,KAAK,CAAC,gBAAgB,CAAE,CAAC,cAChGP,IAAA,CAACG,UAAU,EAACE,KAAK,CAAC,WAAW,CAACC,KAAK,CAAEM,KAAK,CAACO,QAAS,CAACZ,KAAK,CAAC,mBAAmB,CAAE,CAAC,cACjFP,IAAA,CAACG,UAAU,EAACE,KAAK,CAAC,mBAAmB,CAACC,KAAK,CAAEM,KAAK,CAACQ,eAAgB,CAACb,KAAK,CAAC,mBAAmB,CAAE,CAAC,cAChGP,IAAA,CAACG,UAAU,EAACE,KAAK,CAAC,iBAAiB,CAACC,KAAK,CAAEM,KAAK,CAACS,cAAe,CAACd,KAAK,CAAC,kBAAkB,CAAE,CAAC,EACrF,CAAC,EACP,CAAC,CAEV,CAAC,CAED,cAAe,CAAAI,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}