{"ast":null,"code":"import{useEffect,useState,useContext}from\"react\";import api from\"../api\";import{AuthContext}from\"../Context/AuthContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminUsers=()=>{const{token}=useContext(AuthContext);const[users,setUsers]=useState([]);const[loading,setLoading]=useState(true);const headers={Authorization:\"Bearer \".concat(token)};const fetchUsers=async()=>{try{var _ref,_res$data$items;const res=await api.get(\"/users\",{headers});setUsers((_ref=(_res$data$items=res.data.items)!==null&&_res$data$items!==void 0?_res$data$items:res.data)!==null&&_ref!==void 0?_ref:[]);}catch(err){var _err$response;console.error(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message);alert(\"Failed to fetch users\");}finally{setLoading(false);}};const updateRole=async(userId,newRole)=>{try{await api.put(\"/admin/users/\".concat(userId,\"/role\"),{role:newRole},{headers});alert(\"Role updated\");fetchUsers();// Refresh\n}catch(err){var _err$response2;console.error(((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.data)||err.message);alert(\"Failed to update role\");}};const deleteUser=async userId=>{if(!window.confirm(\"Are you sure you want to delete this user?\"))return;try{await api.delete(\"/users/\".concat(userId),{headers});alert(\"User deleted\");fetchUsers();}catch(err){var _err$response3;console.error(((_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.data)||err.message);alert(\"Failed to delete user\");}};useEffect(()=>{fetchUsers();},[]);if(loading)return/*#__PURE__*/_jsx(\"p\",{className:\"text-center mt-10\",children:\"Loading Users...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"p-8 bg-gray-100 min-h-screen\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold mb-6\",children:\"Users Management\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white shadow rounded-lg overflow-hidden\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-800 text-white\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left\",children:\"Username\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left\",children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left\",children:\"Role\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.map(u=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:u.username}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:u.email}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:/*#__PURE__*/_jsxs(\"select\",{value:u.role,onChange:e=>updateRole(u._id,e.target.value),className:\"border rounded p-1\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"user\",children:\"User\"}),/*#__PURE__*/_jsx(\"option\",{value:\"admin\",children:\"Admin\"})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteUser(u._id),className:\"bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700\",children:\"Delete\"})})]},u._id))})]})]});};export default AdminUsers;","map":{"version":3,"names":["useEffect","useState","useContext","api","AuthContext","jsx","_jsx","jsxs","_jsxs","AdminUsers","token","users","setUsers","loading","setLoading","headers","Authorization","concat","fetchUsers","_ref","_res$data$items","res","get","data","items","err","_err$response","console","error","response","message","alert","updateRole","userId","newRole","put","role","_err$response2","deleteUser","window","confirm","delete","_err$response3","className","children","map","u","username","email","value","onChange","e","_id","target","onClick"],"sources":["C:/Users/AK/OneDrive/Attachments/Desktop/CRM/flow-crm/frontend/src/Pages/AdminUsers.jsx"],"sourcesContent":["import { useEffect, useState, useContext } from \"react\";\r\nimport api from \"../api\";\r\nimport { AuthContext } from \"../Context/AuthContext\";\r\n\r\nconst AdminUsers = () => {\r\n  const { token } = useContext(AuthContext);\r\n  const [users, setUsers] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const headers = { Authorization: `Bearer ${token}` };\r\n\r\n  const fetchUsers = async () => {\r\n    try {\r\n      const res = await api.get(\"/users\", { headers });\r\n      setUsers(res.data.items ?? res.data ?? []);\r\n    } catch (err) {\r\n      console.error(err.response?.data || err.message);\r\n      alert(\"Failed to fetch users\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const updateRole = async (userId, newRole) => {\r\n    try {\r\n      await api.put(`/admin/users/${userId}/role`, { role: newRole }, { headers });\r\n      alert(\"Role updated\");\r\n      fetchUsers(); // Refresh\r\n    } catch (err) {\r\n      console.error(err.response?.data || err.message);\r\n      alert(\"Failed to update role\");\r\n    }\r\n  };\r\n\r\n  const deleteUser = async (userId) => {\r\n    if (!window.confirm(\"Are you sure you want to delete this user?\")) return;\r\n    try {\r\n      await api.delete(`/users/${userId}`, { headers });\r\n      alert(\"User deleted\");\r\n      fetchUsers();\r\n    } catch (err) {\r\n      console.error(err.response?.data || err.message);\r\n      alert(\"Failed to delete user\");\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n  }, []);\r\n\r\n  if (loading) return <p className=\"text-center mt-10\">Loading Users...</p>;\r\n\r\n  return (\r\n    <div className=\"p-8 bg-gray-100 min-h-screen\">\r\n      <h2 className=\"text-2xl font-bold mb-6\">Users Management</h2>\r\n      <table className=\"min-w-full bg-white shadow rounded-lg overflow-hidden\">\r\n        <thead className=\"bg-gray-800 text-white\">\r\n          <tr>\r\n            <th className=\"py-3 px-4 text-left\">Username</th>\r\n            <th className=\"py-3 px-4 text-left\">Email</th>\r\n            <th className=\"py-3 px-4 text-left\">Role</th>\r\n            <th className=\"py-3 px-4 text-left\">Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {users.map((u) => (\r\n            <tr key={u._id} className=\"border-b hover:bg-gray-50\">\r\n              <td className=\"py-3 px-4\">{u.username}</td>\r\n              <td className=\"py-3 px-4\">{u.email}</td>\r\n              <td className=\"py-3 px-4\">\r\n                <select\r\n                  value={u.role}\r\n                  onChange={(e) => updateRole(u._id, e.target.value)}\r\n                  className=\"border rounded p-1\"\r\n                >\r\n                  <option value=\"user\">User</option>\r\n                  <option value=\"admin\">Admin</option>\r\n                </select>\r\n              </td>\r\n              <td className=\"py-3 px-4\">\r\n                <button\r\n                  onClick={() => deleteUser(u._id)}\r\n                  className=\"bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700\"\r\n                >\r\n                  Delete\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminUsers;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}